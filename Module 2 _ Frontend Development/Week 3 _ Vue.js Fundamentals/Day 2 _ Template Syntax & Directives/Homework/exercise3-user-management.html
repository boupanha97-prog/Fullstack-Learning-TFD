<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercise 3: User Management</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>[v-cloak] { display: none; }</style>
</head>
<body class="bg-gray-50 min-h-screen p-8">

    <div id="app" v-cloak class="max-w-6xl mx-auto">
        
        <div class="flex justify-between items-center mb-8">
            <div>
                <h1 class="text-3xl font-bold text-gray-900">User Management</h1>
                <p class="text-gray-500">Manage access and roles</p>
            </div>
            <button @click="showAddForm = !showAddForm" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition shadow-lg flex items-center gap-2">
                <span>{{ showAddForm ? 'Cancel' : 'Add New User' }}</span>
            </button>
        </div>

        <!-- Add User Form -->
        <div v-if="showAddForm" class="bg-white p-6 rounded-xl shadow-md mb-8 border border-indigo-100 animate-fade-in">
            <h2 class="text-lg font-bold mb-4 text-gray-800">New User Details</h2>
            <form @submit.prevent="addUser" class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <input v-model="newUser.name" type="text" placeholder="Full Name" required class="border p-2 rounded focus:ring-2 focus:ring-indigo-500 outline-none">
                <input v-model="newUser.email" type="email" placeholder="Email Address" required class="border p-2 rounded focus:ring-2 focus:ring-indigo-500 outline-none">
                <select v-model="newUser.role" class="border p-2 rounded bg-white">
                    <option value="User">User</option>
                    <option value="Admin">Admin</option>
                    <option value="Guest">Guest</option>
                </select>
                <button type="submit" class="bg-green-600 text-white font-bold py-2 rounded hover:bg-green-700">Save User</button>
            </form>
        </div>

        <!-- Filters -->
        <div class="bg-white p-4 rounded-xl shadow-sm mb-6 flex flex-col md:flex-row gap-4 justify-between items-center">
            <div class="flex gap-2">
                <button 
                    v-for="role in ['All', 'Admin', 'User', 'Guest']" 
                    :key="role"
                    @click="filterRole = role"
                    class="px-4 py-2 rounded-lg text-sm font-medium transition"
                    :class="filterRole === role ? 'bg-gray-900 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'"
                >
                    {{ role }}
                </button>
            </div>
            <div class="relative w-full md:w-64">
                <input v-model="search" type="text" placeholder="Search users..." class="w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none">
                <span class="absolute left-3 top-2.5 text-gray-400">üîç</span>
            </div>
        </div>

        <!-- User Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <div v-for="user in filteredUsers" :key="user.id" class="bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition relative group">
                
                <!-- Status Badge -->
                <span 
                    class="absolute top-4 right-4 w-3 h-3 rounded-full"
                    :class="{
                        'bg-green-500': user.status === 'Active',
                        'bg-gray-400': user.status === 'Inactive',
                        'bg-red-500': user.status === 'Suspended'
                    }"
                    :title="user.status"
                ></span>

                <div class="flex items-center gap-4 mb-4">
                    <img :src="user.avatar" :alt="user.name" class="w-16 h-16 rounded-full border-2 border-white shadow-sm bg-gray-100">
                    <div>
                        <h3 class="font-bold text-lg text-gray-900">{{ user.name }}</h3>
                        <p class="text-sm text-gray-500">{{ user.email }}</p>
                    </div>
                </div>

                <div class="space-y-2 text-sm">
                    <div class="flex justify-between border-b border-gray-50 pb-2">
                        <span class="text-gray-500">Role</span>
                        <span class="font-medium px-2 py-0.5 rounded bg-indigo-50 text-indigo-700">{{ user.role }}</span>
                    </div>
                    <div class="flex justify-between border-b border-gray-50 pb-2">
                        <span class="text-gray-500">Joined</span>
                        <span class="font-mono text-gray-700">{{ user.joinDate }}</span>
                    </div>
                    <div class="flex justify-between items-center pt-2">
                        <span class="text-gray-500">Status</span>
                        <select 
                            v-model="user.status" 
                            class="text-xs border rounded px-2 py-1 outline-none cursor-pointer hover:border-gray-400"
                        >
                            <option>Active</option>
                            <option>Inactive</option>
                            <option>Suspended</option>
                        </select>
                    </div>
                </div>

                <!-- Actions -->
                <div class="mt-6 flex gap-2">
                    <button @click="editUser(user)" class="flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 py-2 rounded text-sm font-medium transition">Edit</button>
                    <button @click="deleteUser(user.id)" class="flex-1 bg-red-50 hover:bg-red-100 text-red-600 py-2 rounded text-sm font-medium transition">Delete</button>
                </div>
            </div>
        </div>

        <!-- Empty State -->
        <div v-if="filteredUsers.length === 0" class="text-center py-12">
            <p class="text-gray-400 text-lg">No users found.</p>
        </div>

    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    showAddForm: false,
                    filterRole: 'All',
                    search: '',
                    newUser: {
                        name: '',
                        email: '',
                        role: 'User'
                    },
                    users: [
                        { id: 1, name: 'John Doe', email: 'john@example.com', avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=John', role: 'Admin', status: 'Active', joinDate: '2024-01-15' },
                        { id: 2, name: 'Jane Smith', email: 'jane@example.com', avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Jane', role: 'User', status: 'Active', joinDate: '2024-02-01' },
                        { id: 3, name: 'Bob Wilson', email: 'bob@example.com', avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Bob', role: 'Guest', status: 'Inactive', joinDate: '2024-02-10' },
                        { id: 4, name: 'Alice Cooper', email: 'alice@example.com', avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Alice', role: 'User', status: 'Suspended', joinDate: '2024-01-20' },
                        { id: 5, name: 'Charlie Brown', email: 'charlie@example.com', avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Charlie', role: 'Admin', status: 'Active', joinDate: '2023-12-05' },
                    ]
                }
            },
            computed: {
                filteredUsers() {
                    let result = this.users;

                    if (this.filterRole !== 'All') {
                        result = result.filter(u => u.role === this.filterRole);
                    }

                    if (this.search) {
                        const q = this.search.toLowerCase();
                        result = result.filter(u => 
                            u.name.toLowerCase().includes(q) || 
                            u.email.toLowerCase().includes(q)
                        );
                    }

                    return result;
                }
            },
            methods: {
                addUser() {
                    const user = {
                        id: Date.now(),
                        name: this.newUser.name,
                        email: this.newUser.email,
                        role: this.newUser.role,
                        status: 'Active',
                        joinDate: new Date().toISOString().split('T')[0],
                        avatar: `https://api.dicebear.com/7.x/avataaars/svg?seed=${this.newUser.name}`
                    };
                    this.users.unshift(user);
                    this.newUser.name = '';
                    this.newUser.email = '';
                    this.newUser.role = 'User';
                    this.showAddForm = false;
                },
                deleteUser(id) {
                    if(confirm('Delete this user?')) {
                        this.users = this.users.filter(u => u.id !== id);
                    }
                },
                editUser(user) {
                    const newName = prompt("Edit Name:", user.name);
                    if (newName) user.name = newName;
                }
            }
        }).mount('#app');
    </script>
</body>
</html>