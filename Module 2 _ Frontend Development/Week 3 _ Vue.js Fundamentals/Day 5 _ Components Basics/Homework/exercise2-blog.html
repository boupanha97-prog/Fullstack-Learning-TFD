<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exercise 2: Blog Application</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body class="bg-gray-100 font-sans">
    <div id="app" class="flex flex-col min-h-screen">
        
        <blog-header></blog-header>

        <div class="flex-grow container mx-auto px-4 py-8 flex flex-col md:flex-row gap-8">
            <!-- Main Content -->
            <main class="md:w-2/3 space-y-8">
                <post-card 
                    v-for="post in posts" 
                    :key="post.id" 
                    :post="post"
                ></post-card>
            </main>

            <!-- Sidebar -->
            <aside class="md:w-1/3 space-y-8">
                <sidebar-widget title="About Author">
                    <author-info :author="mainAuthor"></author-info>
                </sidebar-widget>

                <sidebar-widget title="Categories">
                    <ul class="space-y-2">
                        <li v-for="cat in categories" :key="cat" class="text-gray-600 hover:text-blue-600 cursor-pointer flex justify-between">
                            <span>{{ cat.name }}</span>
                            <span class="bg-gray-200 text-xs px-2 py-1 rounded-full">{{ cat.count }}</span>
                        </li>
                    </ul>
                </sidebar-widget>
            </aside>
        </div>

        <blog-footer></blog-footer>
    </div>

    <script>
        const { createApp } = Vue;
        const app = createApp({
            data() {
                return {
                    mainAuthor: {
                        name: 'Alex Writer',
                        avatar: 'https://api.dicebear.com/7.x/avataaars/svg?seed=Alex',
                        bio: 'Tech enthusiast and coffee lover. Sharing thoughts on Vue.js and web development.',
                        postsCount: 42
                    },
                    categories: [
                        { name: 'Technology', count: 15 },
                        { name: 'Lifestyle', count: 8 },
                        { name: 'Coding', count: 12 },
                        { name: 'Travel', count: 5 }
                    ],
                    posts: [
                        {
                            id: 1,
                            title: 'Getting Started with Vue 3',
                            excerpt: 'Vue 3 brings a lot of exciting new features including the Composition API, Teleport, and Fragments...',
                            image: 'https://images.unsplash.com/photo-1498050108023-c5249f4df085?w=800',
                            date: 'Oct 25, 2023',
                            author: 'Alex Writer',
                            likes: 120,
                            comments: [
                                { id: 1, author: 'Sarah', text: 'Great article!', date: '2 hours ago' },
                                { id: 2, author: 'Mike', text: 'Very helpful, thanks.', date: '1 hour ago' }
                            ]
                        },
                        {
                            id: 2,
                            title: 'The Art of Minimalist Design',
                            excerpt: 'Minimalism is not just about using less, it is about making room for what truly matters in your design...',
                            image: 'https://images.unsplash.com/photo-1507525428034-b723cf961d3e?w=800',
                            date: 'Oct 20, 2023',
                            author: 'Alex Writer',
                            likes: 85,
                            comments: []
                        }
                    ]
                }
            }
        });

        // 1. Header
        app.component('blog-header', {
            template: `
                <header class="bg-white shadow-sm sticky top-0 z-50">
                    <div class="container mx-auto px-4 h-16 flex justify-between items-center">
                        <div class="text-2xl font-bold text-gray-800"><span class="text-blue-600">Vue</span>Blog</div>
                        <nav class="hidden md:flex space-x-6 text-gray-600">
                            <a href="#" class="hover:text-blue-600">Home</a>
                            <a href="#" class="hover:text-blue-600">Articles</a>
                            <a href="#" class="hover:text-blue-600">About</a>
                        </nav>
                        <div class="flex items-center gap-4">
                            <div class="relative">
                                <input type="text" placeholder="Search..." class="bg-gray-100 rounded-full px-4 py-1 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <button class="text-gray-600 hover:text-blue-600"><i class="fas fa-user"></i></button>
                        </div>
                    </div>
                </header>
            `
        });

        // 2. Post Card
        app.component('post-card', {
            props: ['post'],
            data() {
                return {
                    liked: false,
                    likesCount: this.post.likes,
                    showComments: false
                }
            },
            methods: {
                toggleLike() {
                    this.liked = !this.liked;
                    this.likesCount += this.liked ? 1 : -1;
                },
                addComment(text) {
                    this.post.comments.push({
                        id: Date.now(),
                        author: 'You',
                        text: text,
                        date: 'Just now'
                    });
                }
            },
            template: `
                <article class="bg-white rounded-xl shadow-sm overflow-hidden hover:shadow-md transition">
                    <img :src="post.image" class="w-full h-64 object-cover">
                    <div class="p-6">
                        <div class="flex items-center gap-2 text-sm text-gray-500 mb-3">
                            <span><i class="far fa-calendar"></i> {{ post.date }}</span>
                            <span>•</span>
                            <span><i class="far fa-user"></i> {{ post.author }}</span>
                        </div>
                        <h2 class="text-2xl font-bold text-gray-800 mb-3">{{ post.title }}</h2>
                        <p class="text-gray-600 mb-4">{{ post.excerpt }}</p>
                        
                        <div class="flex justify-between items-center border-t pt-4">
                            <div class="flex gap-4">
                                <button @click="toggleLike" class="flex items-center gap-1 transition" :class="liked ? 'text-red-500' : 'text-gray-500 hover:text-red-500'">
                                    <i :class="liked ? 'fas fa-heart' : 'far fa-heart'"></i> {{ likesCount }}
                                </button>
                                <button @click="showComments = !showComments" class="flex items-center gap-1 text-gray-500 hover:text-blue-600 transition">
                                    <i class="far fa-comment"></i> {{ post.comments.length }}
                                </button>
                            </div>
                            <button class="text-blue-600 font-bold text-sm hover:underline">Read More →</button>
                        </div>
                    </div>

                    <!-- Comments Section -->
                    <div v-if="showComments" class="bg-gray-50 p-6 border-t">
                        <h3 class="font-bold text-gray-700 mb-4">Comments</h3>
                        <div class="space-y-4 mb-6">
                            <comment-item v-for="comment in post.comments" :key="comment.id" :comment="comment"></comment-item>
                            <p v-if="post.comments.length === 0" class="text-gray-400 text-sm">No comments yet.</p>
                        </div>
                        <comment-form @submit-comment="addComment"></comment-form>
                    </div>
                </article>
            `
        });

        // 3. Author Info
        app.component('author-info', {
            props: ['author'],
            template: `
                <div class="text-center">
                    <img :src="author.avatar" class="w-20 h-20 rounded-full mx-auto mb-3 border-4 border-white shadow-sm">
                    <h3 class="font-bold text-lg text-gray-800">{{ author.name }}</h3>
                    <p class="text-gray-500 text-sm mb-3">{{ author.bio }}</p>
                    <div class="flex justify-center gap-4 text-sm text-gray-600 mb-4">
                        <span><strong>{{ author.postsCount }}</strong> Posts</span>
                        <span><strong>1.2k</strong> Followers</span>
                    </div>
                    <button class="bg-blue-600 text-white px-6 py-2 rounded-full text-sm font-bold hover:bg-blue-700 w-full">Follow</button>
                </div>
            `
        });

        // 4. Comment Item
        app.component('comment-item', {
            props: ['comment'],
            template: `
                <div class="flex gap-3">
                    <div class="w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold text-xs">
                        {{ comment.author[0] }}
                    </div>
                    <div class="flex-grow">
                        <div class="bg-white p-3 rounded-lg rounded-tl-none shadow-sm border border-gray-100">
                            <div class="flex justify-between items-start mb-1">
                                <span class="font-bold text-sm text-gray-900">{{ comment.author }}</span>
                                <span class="text-xs text-gray-400">{{ comment.date }}</span>
                            </div>
                            <p class="text-sm text-gray-700">{{ comment.text }}</p>
                        </div>
                        <div class="flex gap-3 mt-1 text-xs text-gray-500 pl-2">
                            <button class="hover:text-blue-600">Like</button>
                            <button class="hover:text-blue-600">Reply</button>
                        </div>
                    </div>
                </div>
            `
        });

        // 5. Comment Form
        app.component('comment-form', {
            data() {
                return { text: '' }
            },
            computed: {
                charsLeft() { return 500 - this.text.length; }
            },
            methods: {
                submit() {
                    if (this.text.trim()) {
                        this.$emit('submit-comment', this.text);
                        this.text = '';
                    }
                }
            },
            template: `
                <form @submit.prevent="submit">
                    <div class="relative">
                        <textarea 
                            v-model="text" 
                            rows="3" 
                            maxlength="500"
                            placeholder="Write a comment..." 
                            class="w-full border rounded-lg p-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none resize-none"
                        ></textarea>
                        <span class="absolute bottom-2 right-2 text-xs text-gray-400">{{ charsLeft }}</span>
                    </div>
                    <div class="flex justify-end gap-2 mt-2">
                        <button type="button" @click="text=''" class="text-gray-500 text-sm hover:text-gray-700 px-3 py-1">Cancel</button>
                        <button type="submit" class="bg-blue-600 text-white text-sm px-4 py-1.5 rounded-lg font-bold hover:bg-blue-700 disabled:opacity-50" :disabled="!text.trim()">Post</button>
                    </div>
                </form>
            `
        });

        // 6. Sidebar Widget
        app.component('sidebar-widget', {
            props: ['title'],
            template: `
                <div class="bg-white p-6 rounded-xl shadow-sm">
                    <h3 class="font-bold text-gray-800 mb-4 border-l-4 border-blue-600 pl-3">{{ title }}</h3>
                    <slot></slot>
                </div>
            `
        });

        // 7. Footer
        app.component('blog-footer', {
            template: `
                <footer class="bg-gray-800 text-gray-300 py-10 mt-12">
                    <div class="container mx-auto px-4 grid grid-cols-1 md:grid-cols-3 gap-8">
                        <div>
                            <h4 class="text-white font-bold mb-4">VueBlog</h4>
                            <p class="text-sm">A simple blog built with Vue.js components. Learning by doing.</p>
                        </div>
                        <div>
                            <h4 class="text-white font-bold mb-4">Newsletter</h4>
                            <form class="flex gap-2">
                                <input type="email" placeholder="Your email" class="bg-gray-700 border-none rounded px-3 py-2 text-sm w-full focus:ring-2 focus:ring-blue-500">
                                <button class="bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold hover:bg-blue-700">Sub</button>
                            </form>
                        </div>
                        <div>
                            <h4 class="text-white font-bold mb-4">Follow Us</h4>
                            <div class="flex gap-4 text-lg">
                                <a href="#" class="hover:text-white"><i class="fab fa-twitter"></i></a>
                                <a href="#" class="hover:text-white"><i class="fab fa-github"></i></a>
                                <a href="#" class="hover:text-white"><i class="fab fa-linkedin"></i></a>
                            </div>
                        </div>
                    </div>
                    <div class="text-center text-xs text-gray-500 mt-10 border-t border-gray-700 pt-6">
                        &copy; 2023 VueBlog. All rights reserved.
                    </div>
                </footer>
            `
        });

        app.mount('#app');
    </script>
</body>
</html>