<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Exercise 3: Calculator</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen grid place-items-center font-mono">

    <div id="app" class="bg-white p-6 rounded-xl shadow-lg w-96 border border-gray-200" @keyup.enter="calculateLast">
        <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center tracking-wider">CALCULATOR</h2>

        <!-- Inputs -->
        <div class="space-y-3 mb-6">
            <input v-model.number="num1" type="number" placeholder="Number 1" class="w-full p-3 bg-gray-50 border border-gray-300 rounded text-right text-lg focus:outline-none focus:border-blue-500 transition">
            <input v-model.number="num2" type="number" placeholder="Number 2" class="w-full p-3 bg-gray-50 border border-gray-300 rounded text-right text-lg focus:outline-none focus:border-blue-500 transition">
        </div>

        <!-- Error Message -->
        <div v-if="error" class="mb-4 text-red-500 text-sm text-center font-bold bg-red-50 p-2 rounded">
            {{ error }}
        </div>

        <!-- Buttons -->
        <div class="grid grid-cols-4 gap-2 mb-4">
            <button @click="calculate('+')" class="bg-blue-100 hover:bg-blue-200 text-blue-800 p-3 rounded font-bold text-xl transition">+</button>
            <button @click="calculate('-')" class="bg-blue-100 hover:bg-blue-200 text-blue-800 p-3 rounded font-bold text-xl transition">-</button>
            <button @click="calculate('*')" class="bg-blue-100 hover:bg-blue-200 text-blue-800 p-3 rounded font-bold text-xl transition">×</button>
            <button @click="calculate('/')" class="bg-blue-100 hover:bg-blue-200 text-blue-800 p-3 rounded font-bold text-xl transition">÷</button>
        </div>

        <div class="grid grid-cols-2 gap-2 mb-6">
            <button @click="clear" class="bg-red-500 hover:bg-red-600 text-white p-2 rounded font-bold transition">Clear</button>
            <!-- Bonus: Square Root -->
            <button @click="calculate('sqrt')" class="bg-gray-200 hover:bg-gray-300 text-gray-700 p-2 rounded font-bold transition">√</button>
        </div>

        <!-- Result Display -->
        <div class="bg-gray-800 text-green-400 p-4 rounded mb-6 text-right font-bold text-2xl shadow-inner h-20 flex flex-col justify-center">
            <span class="text-xs text-gray-500 block mb-1 h-4">{{ lastOperation }}</span>
            <span>{{ result !== null ? result : '0' }}</span>
        </div>

        <!-- History -->
        <div v-if="history.length > 0">
            <h3 class="text-xs font-bold text-gray-400 uppercase mb-2">History</h3>
            <ul class="space-y-1">
                <li v-for="(item, index) in history" :key="index" class="text-sm text-gray-600 bg-gray-50 p-1 px-2 rounded flex justify-between cursor-pointer hover:bg-gray-100" @click="recall(item)">
                    <span>{{ item.op }}</span>
                    <span class="font-bold">{{ item.res }}</span>
                </li>
            </ul>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        createApp({
            data() {
                return {
                    num1: '',
                    num2: '',
                    result: null,
                    error: '',
                    lastOperation: '',
                    lastOpSymbol: null, // For Enter key support
                    history: []
                }
            },
            methods: {
                calculate(op) {
                    this.error = '';
                    this.lastOpSymbol = op;
                    
                    // Validation
                    if (op !== 'sqrt' && (this.num1 === '' || this.num2 === '')) {
                        this.error = 'Please enter both numbers';
                        return;
                    }
                    if (op === 'sqrt' && this.num1 === '') {
                        this.error = 'Please enter Number 1';
                        return;
                    }

                    let res = 0;
                    let opString = '';

                    switch(op) {
                        case '+': res = this.num1 + this.num2; opString = `${this.num1} + ${this.num2}`; break;
                        case '-': res = this.num1 - this.num2; opString = `${this.num1} - ${this.num2}`; break;
                        case '*': res = this.num1 * this.num2; opString = `${this.num1} × ${this.num2}`; break;
                        case '/': 
                            if(this.num2 === 0) { this.error = "Cannot divide by zero"; return; }
                            res = this.num1 / this.num2; 
                            opString = `${this.num1} ÷ ${this.num2}`;
                            break;
                        case 'sqrt':
                            if(this.num1 < 0) { this.error = "Invalid input"; return; }
                            res = Math.sqrt(this.num1);
                            opString = `√${this.num1}`;
                            break;
                    }

                    // Format result
                    this.result = Number.isInteger(res) ? res : parseFloat(res.toFixed(4));
                    this.lastOperation = `${opString} = ${this.result}`;
                    
                    // Add to history
                    this.history.unshift({ op: opString, res: this.result });
                    if(this.history.length > 5) this.history.pop();
                },
                calculateLast() {
                    if(this.lastOpSymbol) this.calculate(this.lastOpSymbol);
                },
                clear() {
                    this.num1 = '';
                    this.num2 = '';
                    this.result = null;
                    this.error = '';
                    this.lastOperation = '';
                    this.lastOpSymbol = null;
                },
                recall(item) {
                    // Bonus: Click history to see result
                    this.result = item.res;
                }
            }
        }).mount('#app');
    </script>
</body>
</html>